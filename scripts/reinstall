#!/bin/bash

source "$(dirname $_)/shared.sh"

BAK=".backup.sqlite"
APK="${1:-bin/RxDroid.apk}"

if [[ ! -f "$APK" ]]; then
	die "$APK does not exist"
fi

rm -f "$BAK"

scripts/db-backup $BAK || die

echo -n "Removing $PKG ... "
adb uninstall $PKG || die

echo -n "Reinstalling $PKG ... "
adb install $APK || die

scripts/db-restore $BAK || die
rm -f $BAK
